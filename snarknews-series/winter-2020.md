# SnarkNews Winter Series 2020

## Round 1

+ [ ] [Антивирусы: начало](https://contest.yandex.ru/snws2020/contest/16518/problems/A/)
+ [x] [Шифровальщик](https://contest.yandex.ru/snws2020/contest/16518/problems/B/)
+ [x] [Две лаборатории](https://contest.yandex.ru/snws2020/contest/16518/problems/C/)
+ [x] [Уязвимость в микрокоде](https://contest.yandex.ru/snws2020/contest/16518/problems/D/)
+ [x] [Антивирусы и параллелизм](https://contest.yandex.ru/snws2020/contest/16518/problems/E/)
+ [x] [Крипточервь](https://contest.yandex.ru/snws2020/contest/16518/problems/F/)

### A. Антивирусы: начало

题意：给出一个字符串$S$，然后有另外$N$个字符串$s_1,s_2,\dots,s_N$，一开始都是空串。有$Q$个操作，

+ 给出区间$[l,r]$和一个字符串$T$，给区间里的字符串都append一个$T$。
+ 询问区间$[l,r]$里有多少字符串以$S$结尾。

$1 \le |S| \le 20, 1 \le |T| \le 10, 1 \le N, Q \le 10^5, 1 \le l \le r \le N$

题解：把$S$的KMP数组建出来，考虑用KMP匹配的过程，对于每个串实际上只需要维护当前匹配到$S$的哪个位置即可。对于每个字符$c$，我们可以预处理一个数组$p_c(i)$表示当前匹配到$S$的位置$i$，如果再加入一个字符$c$，会匹配到的位置。

我们可以用线段树维护当前区间里匹配到$i$的字符串个数$cnt(i)$，然后第一个操作其实就是对$cnt$数组操作一下。而且$p_c$显然是可以复合的，于是也就可以打标记了。

### B. Шифровальщик

题意：有一个$n \times m$的字符矩阵，另外有个长度为$k$的字符串$s$。你每次可以选择一列循环下移。求最少操作次数使得$s$在某一行中出现。

$1 \le n,m,k \le 500$

题解：处理出$cnt_c(i,j)$表示字符$c$要出现在$(i,j)$的最小次数。然后就枚举$s$在那个位置出现即可。

### C. Две лаборатории

题意：平面上有$N$个点，第$i$个点坐标为$(x_i,y_i)$。你需要找出两个整点$(x_a,y_a)$和$(x_b,y_b)$使得：

+ 最多只有一个点和$(x_a,y_a)$以及$(x_b,y_b)$的距离一样
+ 距离$(x_a,y_a)$比较近的点个数和距离$(x_b,y_b)$比较近的点个数一样

$2 \le N \le 10^5, -10^9 \le x_i, y_i \le 10^9, -10^{18} \le x_a,y_a,x_b,y_b \le 10^{18}
$

题解：如果我们能够找出一条直线能够把这些点分在两侧，那么这个题实际上就做完了，只要取和这条直线垂直的两个点即可。

首先把所有点按照先$x$坐标后$y$坐标的方式排序。然后拿出处于中位数的点作为直线的中点，直接构造即可。

### D. Уязвимость в микрокоде

题意：给出$N$，$K$和$P$，求出有多少个长度为$N$的数组$C$，对$P$取模，满足：

+ $1 \le C_i \le K$

+ 存在两个数$a$和$b$，使得$2 \le a < b \le N$并且$C_a+C_{b-1}=C_b+C_{a-1}$。

$3 \le N \le 10^5, 1 \le K \le 10, 10^8+7 \le P \le 10^9 + 7$，$P$是质数

题解：化简一下就是$C_a-C_{a-1}=C_b-C_{b-1}$，即相邻两项的差。显然这个差最多只有$2K-1$个。

当$N \ge 2K$的时候，所有序列都是可行的。否则$N < 2K$，考虑$O(2^{2K} \cdot N)$的dp即可。

### E. Антивирусы и параллелизм

题意：给出一棵$N$个点的有根树，$1$是根节点，还有个$1$到$N$的排列$P$。你需要把$P$划分成恰好$K$份，每份的代价是这些点LCA的深度。求代价和最小的划分。

$1 \le K \le N \le 300000, NK \le 300000, 1 \le P_i \le N$

题解：先用ST表预处理一下，配合$O(1)$ LCA的话，做到可以$O(1)$查询一段区间的代价。之后令$dp(i,j)$表示把前$j$个数划分成$i$份的最小代价。容易证明这个转移满足决策单调性，直接用$O(N \log N)$的决策单调性即可。

复杂度$O(NK \log N)$。

### F. Крипточервь

题意：有一个$N$面的骰子，每次等概率掷出$1$到$N$某个数。你可以掷最多$K$次，求最优策略下期望能够掷出的最大值。

$1 \le N, K \le 100$

题解：$dp(i) = \frac{1}{N} \sum_{x=1}^{N} \max(x, dp(i-1))$，取$dp(1..N)$的最大值即可。

## Round 2

## Round 3

## Round 4

## Round 5
